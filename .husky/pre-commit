#!/bin/sh
set -e

echo "ğŸš€ Running pre-commit checks..."
echo

# Check if pnpm is available
if ! command -v pnpm &> /dev/null; then
    echo "âŒ Error: pnpm is not installed or not in PATH"
    exit 1
fi

# Run ESLint
echo "ğŸ” Linting code with ESLint..."
if ! pnpm lint; then
    echo "âŒ ESLint found issues. Please fix before committing."
    exit 1
fi
echo "âœ… ESLint passed"
echo

# Run Prettier formatting check
echo "ğŸ’… Checking code formatting with Prettier..."
if ! pnpm format:check; then
    echo "âŒ Code formatting issues found."
    echo "ğŸ’¡ Run 'pnpm format' to automatically fix formatting issues."
    exit 1
fi
echo "âœ… Code formatting is correct"
echo

# Run TypeScript type checking
echo "ğŸ”§ Running TypeScript type checking..."
if ! pnpm typecheck; then
    echo "âŒ TypeScript type errors found. Please fix before committing."
    echo "ğŸ’¡ Run 'pnpm typecheck' to see detailed error information."
    exit 1
fi
echo "âœ… TypeScript compilation successful"
echo

echo "ğŸ‰ All pre-commit checks passed! Ready to commit."
